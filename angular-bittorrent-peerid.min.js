"use strict";angular.module("angularBittorrentPeerid",[]),angular.module("angularBittorrentPeerid").run(function(){"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return this.slice(-t.length)===t}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t,r){return r=r||0,this.slice(r,r+t.length)===t})}),angular.module("angularBittorrentPeerid").factory("peeridUtils",function(){function t(t){var r=t.charCodeAt(0);return r>="0".charCodeAt(0)&&r<="9".charCodeAt(0)}function r(t){var r=t.toLowerCase().charCodeAt(0);return r>="a".charCodeAt(0)&&r<="z".charCodeAt(0)}function e(t,r){r=r||0;for(var e=""+(255&t);e.length<r;)e="0"+e;return e}return{getUtf8Data:function(t){for(var r=[],e=0;e<t.length;e++){var n=t.charCodeAt(e);n<128?r.push(n):n<2048?r.push(n>>6|192,63&n|128):r.push(n>>12|224,n>>6&63|128,63&n|128)}return r},isAzStyle:function(t){return"-"===t.charAt(0)&&("-"===t.charAt(7)||!!["FG","LH","NE","KT","SP"].includes(t.substring(1,3)))},isShadowStyle:function(e){if("-"!==e.charAt(5))return!1;if(!r(e.charAt(0)))return!1;if(!t(e.charAt(1))&&"-"!==e.charAt(1))return!1;for(var n,i=4;i>0&&"-"===e.charAt(i);i--);for(var o=1;o<=i;o++){var a=e.charAt(o);if("-"===a)return!1;if(null===(t(n=a)||r(n)||"."===n))return!1}return!0},isMainlineStyle:function(t){return"-"===t.charAt(2)&&"-"===t.charAt(7)&&("-"===t.charAt(4)||"-"===t.charAt(5))},isPossibleSpoofClient:function(t){return t.endsWith("UDP0")||t.endsWith("HTTPBT")},decodeNumericValueOfByte:e,getAzStyleVersionNumber:function(t,r){return"function"==typeof r?r(t):null},getShadowStyleVersionNumber:function(t){return null},decodeBitSpiritClient:function(t,r){if("BS"!==t.substring(2,4))return null;var e=""+r[1];return"0"===e&&(e=1),{client:"BitSpirit",version:e}},decodeBitCometClient:function(t,r){var n="";if(t.startsWith("exbc"))n="";else if(t.startsWith("FUTB"))n="(Solidox Mod)";else{if(!t.startsWith("xUTB"))return null;n="(Mod 2)"}var i="LORD"===t.substring(6,10),o=i?"BitLord":"BitComet",a=e(r[4]),u=i&&"0"!==a?1:2;return{client:o+(n?" "+n:""),version:a+"."+e(r[5],u)}},identifyAwkwardClient:function(t,r){var e,n=20;for(e=0;e<20;++e)if(r[e]>0){n=e;break}if(0===n){var i=!0;for(e=0;e<16;++e)if(0===r[e]){i=!1;break}if(i){for(e=16;e<20;++e)if(r[e]!==(r[e%16]^r[15-e%16])){i=!1;break}if(i)return{client:"Shareaza"}}}return 9===n&&3===r[9]&&3===r[10]&&3===r[11]?{client:"I2PSnark"}:12===n&&97===r[12]&&97===r[13]?{client:"Experimental",version:"3.2.1b2"}:12===n&&0===r[12]&&0===r[13]?{client:"Experimental",version:"3.1"}:12===n?{client:"Mainline"}:null}}}),angular.module("angularBittorrentPeerid").provider("bittorrentPeeridService",function(){var t={},r={},e={},n={},i={},o=[],a=function(t){return t[0]+"."+t[1]+"."+t[2]},u=function(t){return isNaN(t[2])?t[0]+"."+t[1]+".1"+"ABCDE".indexOf(t[2]):t[0]+"."+t[1]+"."+t[2]},l=function(t){var r=t[3];return r="B"===r?"Beta":"A"===r?"Alpha":"",t[0]+"."+t[1]+"."+t[2]+" "+r},s=function(t){return t[0]+"."+t[1]+"."+t[2]+"."+t[3]},T=function(t){return t[0]+t[1]+"."+t[2]+t[3]},c=function(t){return t[1]+"."+t[2]+t[3]},B=function(t){return"0"===t[0]&&"0"===t[1]&&"0"===t[2]?"0."+t[3]:"0"===t[0]&&"0"===t[1]?"0."+t[2]+t[3]:t[0]+"."+t[1]+t[2]+("Z"===t[3]||"X"===t[3]?"+":"")},d=function(t){var r="";return"0"===t[0]?r+=t[1]+".":r+=""+t[0]+t[1]+".","0"===t[2]?r+=t[3]:r+=""+t[2]+t[3],r},f=this.addAzStyle=function(e,n,i){i=i||s,t[e]=n,r[n]=i},S=this.addShadowStyle=function(t,r,i){i=i||a,e[t]=r,n[r]=i},h=this.addMainlineStyle=function(t,r){i[t]=r},A=this.addSimpleClient=function(t,r,e,n){"number"!=typeof e&&void 0!==e||(n=e,e=r,r=void 0),o.push({id:e,client:t,version:r,position:n||0})};f("A~","Ares",a),f("AG","Ares",a),f("AN","Ares",s),f("AR","Ares"),f("AV","Avicora"),f("AX","BitPump",T),f("AT","Artemis"),f("AZ","Vuze",s),f("BB","BitBuddy","1.234"),f("BC","BitComet",c),f("BE","BitTorrent SDK"),f("BF","BitFlu","NO_VERSION"),f("BG","BTG",s),f("bk","BitKitten (libtorrent)"),f("BR","BitRocket","1.2(34)"),f("BS","BTSlave"),f("BT","BitTorrent",l),f("BW","BitWombat"),f("BX","BittorrentX"),f("CB","Shareaza Plus"),f("CD","Enhanced CTorrent",T),f("CT","CTorrent","1.2.34"),f("DP","Propogate Data Client"),f("DE","Deluge",u),f("EB","EBit"),f("ES","Electric Sheep",a),f("FC","FileCroc"),f("FG","FlashGet",c),f("FX","Freebox BitTorrent"),f("FT","FoxTorrent/RedSwoosh"),f("GR","GetRight","1.2"),f("GS","GSTorrent"),f("HL","Halite",a),f("HN","Hydranode"),f("KG","KGet"),f("KT","KTorrent","1.2.3=[RD].4"),f("LC","LeechCraft"),f("LH","LH-ABC"),f("LK","linkage",a),f("LP","Lphant",T),f("LT","libtorrent (Rasterbar)","2.33.4"),f("lt","libTorrent (Rakshasa)","2.33.4"),f("LW","LimeWire","NO_VERSION"),f("MO","MonoTorrent"),f("MP","MooPolice",a),f("MR","Miro"),f("MT","MoonlightTorrent"),f("NE","BT Next Evolution",a),f("NX","Net Transport"),f("OS","OneSwarm",s),f("OT","OmegaTorrent"),f("PC","CacheLogic","12.3-4"),f("PT","Popcorn Time"),f("PD","Pando"),f("PE","PeerProject"),f("pX","pHoeniX"),f("qB","qBittorrent",u),f("QD","qqdownload"),f("RT","Retriever"),f("RZ","RezTorrent"),f("S~","Shareaza alpha/beta"),f("SB","SwiftBit"),f("SD","迅雷在线 (Xunlei)"),f("SG","GS Torrent",s),f("SN","ShareNET"),f("SP","BitSpirit",a),f("SS","SwarmScope"),f("ST","SymTorrent","2.34"),f("st","SharkTorrent"),f("SZ","Shareaza"),f("TG","Torrent GO"),f("TN","Torrent.NET"),f("TR","Transmission",B),f("TS","TorrentStorm"),f("TT","TuoTu",a),f("UL","uLeecher!"),f("UE","µTorrent Embedded",l),f("UT","µTorrent",l),f("UM","µTorrent Mac",l),f("UW","µTorrent Web",l),f("WD","WebTorrent Desktop",d),f("WT","Bitlet"),f("WW","WebTorrent",d),f("WY","FireTorrent"),f("VG","哇嘎 (Vagaa)",s),f("XL","迅雷在线 (Xunlei)"),f("XT","XanTorrent"),f("XF","Xfplay",B),f("XX","XTorrent","1.2.34"),f("XC","XTorrent","1.2.34"),f("ZT","ZipTorrent"),f("7T","aTorrent"),f("ZO","Zona",s),f("#@","Invalid PeerID"),S("A","ABC"),S("O","Osprey Permaseed"),S("Q","BTQueue"),S("R","Tribler"),S("S","Shad0w"),S("T","BitTornado"),S("U","UPnP NAT"),h("M","Mainline"),h("Q","Queen Bee"),A("µTorrent","1.7.0 RC","-UT170-"),A("Azureus","1","Azureus"),A("Azureus","2.0.3.2","Azureus",5),A("Aria","2","-aria2-"),A("BitTorrent Plus!","II","PRC.P---"),A("BitTorrent Plus!","P87.P---"),A("BitTorrent Plus!","S587Plus"),A("BitTyrant (Azureus Mod)","AZ2500BT"),A("Blizzard Downloader","BLZ"),A("BTGetit","BG",10),A("BTugaXP","btuga"),A("BTugaXP","BTuga",5),A("BTugaXP","oernu"),A("Deadman Walking","BTDWV-"),A("Deadman","Deadman Walking-"),A("External Webseed","Ext"),A("G3 Torrent","-G3"),A("GreedBT","2.7.1","271-"),A("Hurricane Electric","arclight"),A("HTTP Seed","-WS"),A("JVtorrent","10-------"),A("Limewire","LIME"),A("Martini Man","martini"),A("Pando","Pando"),A("PeerApp","PEERAPP"),A("SimpleBT","btfans",4),A("Swarmy","a00---0"),A("Swarmy","a02---0"),A("Teeweety","T00---0"),A("TorrentTopia","346-"),A("XanTorrent","DansClient"),A("MediaGet","-MG1"),A("MediaGet","2.1","-MG21"),A("Amazon AWS S3","S3-"),A("BitTorrent DNA","DNA"),A("Opera","OP"),A("Opera","O"),A("Burst!","Mbrst"),A("TurboBT","turbobt"),A("BT Protocol Daemon","btpd"),A("Plus!","Plus"),A("XBT","XBT"),A("BitsOnWheels","-BOW"),A("eXeem","eX"),A("MLdonkey","-ML"),A("Bitlet","BitLet"),A("AllPeers","AP"),A("BTuga Revolution","BTM"),A("Rufus","RS",2),A("BitMagnet","BM",2),A("QVOD","QVOD"),A("Top-BT","TB"),A("Tixati","TIX"),A("folx","-FL"),A("µTorrent Mac","-UM"),A("µTorrent","-UT"),this.$get=["peeridUtils",function(n){return{parseClient:function(a){var u=n.getUtf8Data(a),l=null;if(n.isPossibleSpoofClient(a))return(l=n.decodeBitSpiritClient(a,u))?l:(l=n.decodeBitCometClient(a,u))?l:{client:"BitSpirit?"};if(n.isAzStyle(a)&&(l=function(r){return t[r.substring(1,3)]}(a))){var s=function(t,e){var i=r[t];return i?n.getAzStyleVersionNumber(e.substring(3,7),i):null}(l,a);return l.startsWith("ZipTorrent")&&a.startsWith("bLAde",8)?{client:"Unknown [Fake: ZipTorrent]",version:s}:"µTorrent"===l&&"6.0 Beta"===s?{client:"Mainline",version:"6.0 Beta"}:l.startsWith("libTorrent (Rakshasa)")?{client:l+" / rTorrent*",version:s}:{client:l,version:s}}if(n.isShadowStyle(a)&&(l=function(t){return e[t.substring(0,1)]}(a)))return{client:l};if(n.isMainlineStyle(a)&&(l=function(t){return i[t.substring(0,1)]}(a)))return{client:l};if(l=n.decodeBitSpiritClient(a,u))return l;if(l=n.decodeBitCometClient(a,u))return l;var T=function(t){for(var r=0;r<o.length;++r){var e=o[r];if(t.startsWith(e.id,e.position))return e}return null}(a);return T?{client:l=T.client,version:T.version}:(l=n.identifyAwkwardClient(a,u))?l:{client:"unknown"}}}}]});