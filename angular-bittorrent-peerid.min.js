"use strict";angular.module("angularBittorrentPeerid",[]),angular.module("angularBittorrentPeerid").run(function(){"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return this.slice(-a.length)===a}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a,b){return b=b||0,this.slice(b,b+a.length)===a})}),angular.module("angularBittorrentPeerid").factory("peeridUtils",function(){function a(a){var b=a.charCodeAt(0);return b>="0".charCodeAt(0)&&b<="9".charCodeAt(0)}function b(a){var b=a.toLowerCase().charCodeAt(0);return b>="a".charCodeAt(0)&&b<="z".charCodeAt(0)}function c(c){return a(c)||b(c)||"."===c}function d(a,b){b=b||0;for(var c=""+(255&a);c.length<b;)c="0"+c;return c}return{getUtf8Data:function(a){var c,d,b=[];for(c=0;c<a.length;c++)d=a.charCodeAt(c),128>d?b.push(d):2048>d?b.push(192|d>>6,128|63&d):b.push(224|d>>12,128|63&d>>6,128|63&d);return b},isAzStyle:function(a){return"-"!==a.charAt(0)?!1:"-"===a.charAt(7)?!0:"FG"===a.substring(1,3)?!0:"LH"===a.substring(1,3)?!0:"NE"===a.substring(1,3)?!0:"KT"===a.substring(1,3)?!0:"SP"===a.substring(1,3)?!0:!1},isShadowStyle:function(d){var e,f,g;if("-"!==d.charAt(5))return!1;if(!b(d.charAt(0)))return!1;if(!a(d.charAt(1))&&"-"!==d.charAt(1))return!1;for(e=4;e>0&&"-"===d.charAt(e);e--);for(f=1;e>=f;f++){if(g=d.charAt(f),"-"===g)return!1;if(null===c(g))return!1}return!0},isMainlineStyle:function(a){return"-"===a.charAt(2)&&"-"===a.charAt(7)&&("-"===a.charAt(4)||"-"===a.charAt(5))},isPossibleSpoofClient:function(a){return a.endsWith("UDP0")||a.endsWith("HTTPBT")},decodeNumericValueOfByte:d,getAzStyleVersionNumber:function(a,b){return"function"==typeof b?b(a):null},getShadowStyleVersionNumber:function(){return null},decodeBitSpiritClient:function(a,b){if("BS"!==a.substring(2,4))return null;var c=""+b[1];return"0"===c&&(c=1),{client:"BitSpirit",version:c}},decodeBitCometClient:function(a,b){var e,f,g,h,c="";if(a.startsWith("exbc"))c="";else if(a.startsWith("FUTB"))c="(Solidox Mod)";else{if(!a.startsWith("xUTB"))return null;c="(Mod 2)"}return e="LORD"===a.substring(6,10),f=e?"BitLord":"BitComet",g=d(b[4]),h=e&&"0"!==g?1:2,{client:f+(c?" "+c:""),version:g+"."+d(b[5],h)}},identifyAwkwardClient:function(a,b){var d,e,c=20;for(d=0;20>d;++d)if(b[d]>0){c=d;break}if(0===c){for(e=!0,d=0;16>d;++d)if(0===b[d]){e=!1;break}if(e){for(d=16;20>d;++d)if(b[d]!==(b[d%16]^b[15-d%16])){e=!1;break}if(e)return{client:"Shareaza"}}}return 9===c&&3===b[9]&&3===b[10]&&3===b[11]?{client:"I2PSnark"}:12===c&&97===b[12]&&97===b[13]?{client:"Experimental",version:"3.2.1b2"}:12===c&&0===b[12]&&0===b[13]?{client:"Experimental",version:"3.1"}:12===c?{client:"Mainline"}:null}}}),angular.module("angularBittorrentPeerid").provider("bittorrentPeeridService",function(){var a={},b={},c={},d={},e={},f=[],g=function(a){return a[0]+"."+a[1]+"."+a[2]},h=function(a){var b="ABCDE";return isNaN(a[2])?a[0]+"."+a[1]+".1"+b.indexOf(a[2]):a[0]+"."+a[1]+"."+a[2]},i=function(a){var b=a[3];return b="B"===b?"Beta":"A"===b?"Alpha":"",a[0]+"."+a[1]+"."+a[2]+" "+b},j=function(a){return a[0]+"."+a[1]+"."+a[2]+"."+a[3]},k=function(a){return a[0]+a[1]+"."+a[2]+a[3]},l=function(a){return a[1]+"."+a[2]+a[3]},m="1.2.3=[RD].4",n=function(a){return"0"===a[0]&&"0"===a[1]&&"0"===a[2]?"0."+a[3]:"0"===a[0]&&"0"===a[1]?"0."+a[2]+a[3]:a[0]+"."+a[1]+a[2]+("Z"===a[3]||"X"===a[3]?"+":"")},o=function(a){var b="";return b+="0"===a[0]?a[1]+".":""+a[0]+a[1]+".",b+="0"===a[2]?a[3]:""+a[2]+a[3]},p="2.33.4",q="NO_VERSION",r=this.addAzStyle=function(c,d,e){e=e||j,a[c]=d,b[d]=e},s=this.addShadowStyle=function(a,b,e){e=e||g,c[a]=b,d[b]=e},t=this.addMainlineStyle=function(a,b){e[a]=b},u=this.addSimpleClient=function(a,b,c,d){("number"==typeof c||"undefined"==typeof c)&&(d=c,c=b,b=void 0),f.push({id:c,client:a,version:b,position:d||0})};!function(){r("A~","Ares",g),r("AG","Ares",g),r("AN","Ares",j),r("AR","Ares"),r("AV","Avicora"),r("AX","BitPump",k),r("AT","Artemis"),r("AZ","Vuze",j),r("BB","BitBuddy","1.234"),r("BC","BitComet",l),r("BE","BitTorrent SDK"),r("BF","BitFlu",q),r("BG","BTG",j),r("bk","BitKitten (libtorrent)"),r("BR","BitRocket","1.2(34)"),r("BS","BTSlave"),r("BT","BitTorrent",i),r("BW","BitWombat"),r("BX","BittorrentX"),r("CB","Shareaza Plus"),r("CD","Enhanced CTorrent",k),r("CT","CTorrent","1.2.34"),r("DP","Propogate Data Client"),r("DE","Deluge",h),r("EB","EBit"),r("ES","Electric Sheep",g),r("FC","FileCroc"),r("FG","FlashGet",l),r("FT","FoxTorrent/RedSwoosh"),r("GR","GetRight","1.2"),r("GS","GSTorrent"),r("HL","Halite",g),r("HN","Hydranode"),r("KG","KGet"),r("KT","KTorrent",m),r("LC","LeechCraft"),r("LH","LH-ABC"),r("LK","linkage",g),r("LP","Lphant",k),r("LT","libtorrent (Rasterbar)",p),r("lt","libTorrent (Rakshasa)",p),r("LW","LimeWire",q),r("MO","MonoTorrent"),r("MP","MooPolice",g),r("MR","Miro"),r("MT","MoonlightTorrent"),r("NE","BT Next Evolution",g),r("NX","Net Transport"),r("OS","OneSwarm",j),r("OT","OmegaTorrent"),r("PC","CacheLogic","12.3-4"),r("PT","Popcorn Time"),r("PD","Pando"),r("PE","PeerProject"),r("pX","pHoeniX"),r("qB","qBittorrent",h),r("QD","qqdownload"),r("RT","Retriever"),r("RZ","RezTorrent"),r("S~","Shareaza alpha/beta"),r("SB","SwiftBit"),r("SD","迅雷在线 (Xunlei)"),r("SG","GS Torrent",j),r("SN","ShareNET"),r("SP","BitSpirit",g),r("SS","SwarmScope"),r("ST","SymTorrent","2.34"),r("st","SharkTorrent"),r("SZ","Shareaza"),r("TN","Torrent.NET"),r("TR","Transmission",n),r("TS","TorrentStorm"),r("TT","TuoTu",g),r("UL","uLeecher!"),r("UE","µTorrent Embedded",i),r("UT","µTorrent",i),r("UM","µTorrent Mac",i),r("WD","WebTorrent Desktop",o),r("WT","Bitlet"),r("WW","WebTorrent",o),r("WY","FireTorrent"),r("VG","哇嘎 (Vagaa)",j),r("XL","迅雷在线 (Xunlei)"),r("XT","XanTorrent"),r("XF","Xfplay",n),r("XX","XTorrent","1.2.34"),r("XC","XTorrent","1.2.34"),r("ZT","ZipTorrent"),r("7T","aTorrent"),r("ZO","Zona",j),r("#@","Invalid PeerID"),s("A","ABC"),s("O","Osprey Permaseed"),s("Q","BTQueue"),s("R","Tribler"),s("S","Shad0w"),s("T","BitTornado"),s("U","UPnP NAT"),t("M","Mainline"),t("Q","Queen Bee"),u("µTorrent","1.7.0 RC","-UT170-"),u("Azureus","1","Azureus"),u("Azureus","2.0.3.2","Azureus",5),u("Aria","2","-aria2-"),u("BitTorrent Plus!","II","PRC.P---"),u("BitTorrent Plus!","P87.P---"),u("BitTorrent Plus!","S587Plus"),u("BitTyrant (Azureus Mod)","AZ2500BT"),u("Blizzard Downloader","BLZ"),u("BTGetit","BG",10),u("BTugaXP","btuga"),u("BTugaXP","BTuga",5),u("BTugaXP","oernu"),u("Deadman Walking","BTDWV-"),u("Deadman","Deadman Walking-"),u("External Webseed","Ext"),u("G3 Torrent","-G3"),u("GreedBT","2.7.1","271-"),u("Hurricane Electric","arclight"),u("HTTP Seed","-WS"),u("JVtorrent","10-------"),u("Limewire","LIME"),u("Martini Man","martini"),u("Pando","Pando"),u("PeerApp","PEERAPP"),u("SimpleBT","btfans",4),u("Swarmy","a00---0"),u("Swarmy","a02---0"),u("Teeweety","T00---0"),u("TorrentTopia","346-"),u("XanTorrent","DansClient"),u("MediaGet","-MG1"),u("MediaGet","2.1","-MG21"),u("Amazon AWS S3","S3-"),u("BitTorrent DNA","DNA"),u("Opera","OP"),u("Opera","O"),u("Burst!","Mbrst"),u("TurboBT","turbobt"),u("BT Protocol Daemon","btpd"),u("Plus!","Plus"),u("XBT","XBT"),u("BitsOnWheels","-BOW"),u("eXeem","eX"),u("MLdonkey","-ML"),u("Bitlet","BitLet"),u("AllPeers","AP"),u("BTuga Revolution","BTM"),u("Rufus","RS",2),u("BitMagnet","BM",2),u("QVOD","QVOD"),u("Top-BT","TB"),u("Tixati","TIX"),u("folx","-FL"),u("µTorrent Mac","-UM"),u("µTorrent","-UT")}(),this.$get=["peeridUtils",function(d){var g=function(b){return a[b.substring(1,3)]},h=function(a){return c[a.substring(0,1)]},i=function(a){return e[a.substring(0,1)]},j=function(a){var b,c;for(b=0;b<f.length;++b)if(c=f[b],a.startsWith(c.id,c.position))return c;return null},k=function(a,c){var e=b[a];return e?d.getAzStyleVersionNumber(c.substring(3,7),e):null},l=function(a){var e,f,b=d.getUtf8Data(a),c=null;return d.isPossibleSpoofClient(a)?(c=d.decodeBitSpiritClient(a,b))?c:(c=d.decodeBitCometClient(a,b))?c:{client:"BitSpirit?"}:d.isAzStyle(a)&&(c=g(a))?(e=k(c,a),c.startsWith("ZipTorrent")&&a.startsWith("bLAde",8)?{client:"Unknown [Fake: ZipTorrent]",version:e}:"µTorrent"===c&&"6.0 Beta"===e?{client:"Mainline",version:"6.0 Beta"}:c.startsWith("libTorrent (Rakshasa)")?{client:c+" / rTorrent*",version:e}:{client:c,version:e}):d.isShadowStyle(a)&&(c=h(a))?{client:c}:d.isMainlineStyle(a)&&(c=i(a))?{client:c}:(c=d.decodeBitSpiritClient(a,b))?c:(c=d.decodeBitCometClient(a,b))?c:(f=j(a),f?(c=f.client,{client:c,version:f.version}):(c=d.identifyAwkwardClient(a,b))?c:{client:"unknown"})};return{parseClient:l}}]});